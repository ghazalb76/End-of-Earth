<html>
    <head>
        <link rel="stylesheet" href="bootstrap.css">
        <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js" type="text/javascript"></script>
        <style>
        </style>
            <script >

                var pushSocket = new WebSocket("ws://localhost:8080")
                var newData;
                pushSocket.onmessage = function (event) {
                console.log(event.data);
                newData = event.data;
                if(newData.includes("#")){
                    dollarAdd(event.data);
                }
                //do ui update here
                }

                pushSocket.onopen = function (event) {
                    //send empty message to initialize socket connnection
                    pushSocket.send("");
                };

                pushSocket.onclose = function (event) {
                //send empty message to initialize socket connnection
                //alert("Socket Closed by Server");
                };
                var d = new Date();
                var rowCounter = 0;

                function dollarAdd() {
                    rowCounter +=1;
                    var d = new Date();
                    $("#myTable tbody").prepend(
                        "<tr>" +
                            "<td id='"+rowCounter+"'"+">"+newData+"</td>" +
                            "<td>"+d.getHours()+":"+d.getMinutes()+":"+d.getSeconds()+"</td>" +
                            "<td>"+1+"</td>" +
                        "</tr>"
                    );
                    var myTable = document.getElementById("myTable");
                    for(var i=2 ;i< $('#myTable tr').length ;i++){
                        myTable.rows[i].cells[2].innerHTML = i;
                        if(myTable.rows[i].cells[2].innerHTML == 11){
                            document.getElementById("myTable").deleteRow(myTable.rows[i].cells[2].innerHTML);
                        }
                    }
                }
    
            </script>
        
    </head>
    <body>
            <p id="demo"></p>
            <table class="table table-striped" id="myTable">
                    <thead class="grey">
                        <tr>
                        <th scope="col">قیمت</th>
                        <th scope="col">زمان</th>
                        <th scope="col">ردیف</th>
                        </tr>
                    </thead>
                    <tbody>
                    </tbody>
                    </table>
                      
        </body>

</html>
